<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="log.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=PT+Sans+Narrow&display=swap" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Krona+One&display=swap');
		
        </style>

    
    <title>Tuition Reimbursement Management System</title>

<script>

const cat = localStorage.getItem('id');
let xhr = new XMLHttpRequest();



xhr.onreadystatechange = function () {

if (this.readyState == 4 & this.status == 200) {

    let resp = JSON.parse(this.responseText);
    console.log(resp);
    temp = String(resp.contactId.id);
    console.log(temp);
    var fname = document.getElementById("fname");
    var lname = document.getElementById("lname");
    var email = document.getElementById("email");
    var pass = document.getElementById("pass");
    var address = document.getElementById("address");
    var address2 = document.getElementById("address2");
    var email = document.getElementById("email");
    var password = document.getElementById("pass");
    var phone = document.getElementById("phone");
    var city = document.getElementById("city");
    var state = document.getElementById("state");
    var zip = document.getElementById("zip");
    fname.value = resp.firstName;
    lname.value = resp.lastName;
    address.value = resp.contactId.address1;
    address2.value = resp.contactId.address2;
    email.value = resp.email;
    password.value = resp.password;
    phone.value = resp.contactId.phone;
    city.value = resp.contactId.city;
    state.value = resp.contactId.state;
    zip.value = resp.contactId.zip;
    con = resp.contactId;

}
};


url = "http://localhost:7000/employees/" + cat;
xhr.open("GET", url, true);

xhr.send();





function go(){


    let address = document.getElementById("address").value;
    let address2 = document.getElementById("address2").value;
    let password = document.getElementById("pass").value;
    let phone = document.getElementById("phone").value;
    let city = document.getElementById("city").value;
    let state = document.getElementById("state").value;
    let zip = document.getElementById("zip").value;

let xhttp = new XMLHttpRequest();

xhttp.onreadystatechange = function () {

    if (this.readyState == 4 && this.status == 200) {
        console.log(this.responseText);

        if (JSON.parse(this.responseText)) {
            document.getElementById("success").innerHTML = "Employee Updated"
        } else {
            document.getElementById("success").innerHTML = "Employee Updated"
        }
    } else if (this.readyState == 4) {
        document.getElementById("success").innerHTML = "Request was not successfully processed!"
    }

}

let url = "http://localhost:7000/contacts/" + temp;
xhttp.open("PUT", url, true);


xhttp.setRequestHeader('Content-Type', 'application/json');

let contact = {
    address1: address,
    address2: address2,
    city: city,
    phone: phone,
    state: state,
    zip: zip
}



//The optional argument in the send() method allows us to provide a body.
xhttp.send(JSON.stringify(contact));


    let fname = document.getElementById("fname").value;
    let lname = document.getElementById("lname").value;
    let pass = document.getElementById("pass").value;
    let email = document.getElementById("email").value;

    let xhttp2 = new XMLHttpRequest();

xhttp2.onreadystatechange = function () {

    if (this.readyState == 4 && this.status == 200) {
        console.log(this.responseText);

        if (JSON.parse(this.responseText)) {
            document.getElementById("success").innerHTML = "Employee Updated"
        } else {
            document.getElementById("success").innerHTML = "Employee Updated"
        }
    } else if (this.readyState == 4) {
        document.getElementById("success").innerHTML = "Request was not successfully processed!"
    }

}

let url2 = "http://localhost:7000/employees/" + cat;
xhttp2.open("PUT", url2, true);

xhttp2.setRequestHeader('Content-Type', 'application/json');

let employee = {
    firstName: fname,
    lastName: lname,
    password: pass,
    email: email,
    contactId: contact,
    managmentId: con
}


xhttp2.send(JSON.stringify(employee));


}

</script>



</head>
<body>

    <nav>
        <div class="logo">
            
            <img src="logo.png" alt="">
        </div>
            <ul class="nav-links">
                <li><a href="employee.html">Tuition Reimbursement</a></li>
                <li><a href="result.html">Pending/Completed</a></li>
                <li><a href="contact.html">Contact Information</a></li>
                <li><a href="login.html">Log in</a></li>
            </ul>

    </nav>

  <div class="wrapper">
  <div class="left">
      <p>Update Contact Information</p>   
      
      
  </div>
  <div class="right">

    
    <div class="signup">

        

    </div>
    
    <div class="login">
	      
        <div class="input_field">
            <label>First Name</label>
            <input id="fname" type="text" name="fname" class="form-control">
        </div>
        <div class="input_field">
            <label>Last Name</label>
            <input id="lname" type="text" name="lname" class="form-control">
        </div>
        <div class="input_field">
            <label>Email</label>
            <input id="email" type="text" name="email" class="form-control">
        </div>
        <div class="input_field">
            <label>Password</label>
            <input id="pass" type="password" name="pass" class="form-control">
        </div>
        <div class="input_field">
            <label>Phone Number</label>
            <input id="phone" type="text" name="phone" class="form-control">
        </div>
        <div class="input_field">
            <label>Address</label>
            <input id="address" type="text" name="address" class="form-control">
        </div>
        <div class="input_field">
            <label>Address 2</label>
            <input id="address2" type="text" name="address2" class="form-control">
        </div>
        <div class="input_field">
            <label>City</label>
            <input id="city" type="text" name="city" class="form-control">
        </div>
        <div class="input_field">
            <label>State</label>
            <input id="state" type="text" name="state" class="form-control">
        </div>
        <div class="input_field">
            <label>Zip Code</label>
            <input id="zip" type="text" name="zip" class="form-control">
        </div>

        <div class="btn">
            <input type="submit" onclick="go()" class="sub" value="UPDATE">
        </div>

        <p id="success"></p>
        
     
    </div>
    
  </div>
</div>

    <footer style="width:98.5%;">
        
            <div class="l-footer">
                <h3></h3>
                <p></p>
                

            </div>
            <ul class="r-footer">
			<br />
				<p></p>                 
                <!--<li><p></p></li>-->
            </ul>

        </div>
    </footer>
    </body>
</html>